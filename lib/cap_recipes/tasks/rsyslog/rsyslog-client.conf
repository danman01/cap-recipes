 certificate files - just CA for a client
#$DefaultNetstreamDriverCAFile /etc/rsyslog/ca.pem

## set up the action  (put SSL first before *.* message forwarding)
#$DefaultNetstreamDriver gtls # use gtls netstream driver
#$ActionSendStreamDriverMode 1 # require TLS for the connection
#$ActionSendStreamDriverAuthMode anon # server is NOT authenticated

# An on-disk queue is created for this action. If the remote host is
# down, messages are spooled to disk and sent when it is up again.
# check website: http://www.rsyslog.com/doc-rsyslog_reliable_forwarding.html
# this reliable log forwarding function is different with RELP protocol which is more reliable

$RepeatedMsgReduction on

$CreateDirs on
$DirCreateMode 0755
$FileOwner syslog
$FileGroup adm
$FileCreateMode 0640
$DirCreateMode 0755
$Umask 0022
$PrivDropToUser syslog
$PrivDropToGroup adm

$ModLoad imuxsock             # local message reception
$WorkDirectory /var/log/rsyslog # default location for work (spool) files
$ActionQueueType LinkedList   # run asynchronously
$ActionQueueFileName rsyslog  # set file name, also enables disk mode
$ActionQueueMaxDiskSpace 1g   # 1gb space limit (use as much as possible)
$ActionResumeRetryCount -1    # infinite retries if host is down
$ActionQueueSaveOnShutdown on # save in-memory data if rsyslog shuts down

*.*              @@<%=rsyslog_master%>:514 # send (all) messages to the syslog server